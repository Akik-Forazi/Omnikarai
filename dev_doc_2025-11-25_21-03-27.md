# Development Log - 2025-11-25

## Objective: Build a Native JIT Compiler for Omnikarai

Today's session was focused on laying the foundational infrastructure for a native Just-In-Time (JIT) compiler for the Omnikarai language using the LLVM compiler infrastructure.

### Key Achievements:

1.  **Toolchain Setup & LLVM Integration:**
    *   The LLVM 15 development libraries were identified as the core backend technology.
    *   The necessary packages (`llvm-15-dev`, `liblld-15-dev`, etc.) were installed via `apt-get`.
    *   The project's `Makefile` was significantly updated to dynamically link against the LLVM libraries using `llvm-config-15`.

2.  **JIT Engine Scaffolding:**
    *   A dedicated JIT execution engine was created (`jit_engine.c`, `jit_engine.h`) to encapsulate the logic for compiling LLVM IR into native machine code and executing it.
    *   The main program (`main.c`) was modified to accept a `-jit` command-line flag, allowing for seamless switching between the original tree-walk interpreter and the new JIT compilation path.

3.  **End-to-End Pipeline Verification:**
    *   A minimal compiler (`compiler.c`) was implemented to generate a simple LLVM module containing a `main` function that returned a hardcoded integer (`42`).
    *   This allowed for a successful end-to-end test of the entire pipeline: `Omnikarai Source -> Parser (AST) -> Compiler (LLVM IR) -> JIT Engine (Machine Code) -> Execution`.

4.  **AST-Driven Compilation (Initial Steps):**
    *   The compiler was enhanced to be data-driven by the Abstract Syntax Tree (AST).
    *   Implementation for `INTEGER_LITERAL` nodes was added, allowing the compiler to generate code for integer constants present in the source file.
    *   Support for `INFIX_EXPRESSION` nodes was added, enabling the compilation of basic arithmetic operations (`+`, `-`, `*`, `/`).

5.  **Symbol Table for Variables:**
    *   To handle state and move beyond the compile-time constant folding performed by LLVM, work began on supporting variables.
    *   A generic hash-map-based symbol table (`symbol_table.c`, `symbol_table.h`) was created to store and retrieve variable mappings.
    *   The build system was updated to include these new files.

### Next Steps:

*   Integrate the symbol table into the compiler.
*   Implement compilation for `set` statements to handle variable assignment.
*   Implement compilation for `IDENTIFIER` expressions to handle variable lookups.
